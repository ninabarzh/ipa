{{- $index := slice -}}
{{- range where .Site.RegularPages "Lang" .Site.Language.Lang -}}
  {{- $isSearch := or (eq .Type "search") (eq .Layout "search") -}}
  {{- if and (not .Params.excludeFromSearch) (not $isSearch) -}}
    {{- $index = $index | append (dict
      "title" (.Title | default "")
      "description" (.Params.description | default "")
      "content" (.Plain | default "")
      "permalink" (.Permalink | default "")
    ) -}}
  {{- end -}}
{{- end -}}
{{- $index | jsonify -}}
